<!DOCTYPE html>
<html>

<head>
    <title>Matchup Data</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }

        th,
        td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }
    </style>
</head>

<body>
    <h1>Matchup Data</h1>
    <table>
        <thead>
            <tr>
                <th>Team</th>
                <th>Wins</th>
                <th>Losses</th>
            </tr>
        </thead>
        <tbody>
            <!-- Table will be populated by JavaScript -->
        </tbody>
    </table>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script>
        const tableBody = document.querySelector('tbody');

        // Function to count the occurrences of each team in the winner and loser columns
        function countOccurrences(data) {
            const teams = {};

            // Loop through each row in the CSV data
            data.forEach(row => {
                const winner = row.Winner;
                const loser = row.Loser;

                // Count the wins for each team
                if (winner in teams) {
                    teams[winner].wins++;
                } else {
                    teams[winner] = { wins: 1, losses: 0 };
                }

                // Count the losses for each team
                if (loser in teams) {
                    teams[loser].losses++;
                } else {
                    teams[loser] = { wins: 0, losses: 1 };
                }
            });

            return teams;
        }

        // Fetch the CSV data from the correct path
        fetch('data/league_outcomes.csv')
            .then(response => response.text())
            .then(data => {
                // Parse the CSV data
                const parsedData = Papa.parse(data, { header: true }).data;

                // Count the occurrences of each team
                const teamOccurrences = countOccurrences(parsedData);

                // Populate the table with the team data
                Object.keys(teamOccurrences).forEach(team => {
                    const row = document.createElement('tr');

                    const teamCell = document.createElement('td');
                    teamCell.textContent = team;
                    row.appendChild(teamCell);

                    const winsCell = document.createElement('td');
                    winsCell.textContent = teamOccurrences[team].wins;
                    row.appendChild(winsCell);

                    const lossesCell = document.createElement('td');
                    lossesCell.textContent = teamOccurrences[team].losses;
                    row.appendChild(lossesCell);

                    const winPercentageCell = document.createElement('td');
                    winPercentageCell.textContent = (teamOccurrences[team].wins / (teamOccurrences[team].wins + teamOccurrences[team].losses)).toFixed(2);  
                    row.appendChild(winPercentageCell);

                    tableBody.appendChild(row);
                });
            })
            .catch(error => {
                console.error('Error:', error);
            });
    </script>
</body>
</html>